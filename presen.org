#+title: Next Step in AI technology
#+author: 
#+include: "head.org"
#+LINK: img file:img/%s
#+LINK: png file:img/%s.png
#+LINK: jpg file:img/%s.jpg

# #+HTML: <script type="text/javascript" src="js/mathjaxconf.js"></script>

# ターゲット: 計算機科学の知識はない理系の人



#+BEGIN_outline-text-1
#+BEGIN_CENTER
Masataro Asai (Doctoral Student)


#+BEGIN_CONTAINER-FLUID
#+BEGIN_ROW-FLUID
#+BEGIN_SPAN6
[[png:astro]]
#+END_SPAN6
#+BEGIN_SPAN6
[[png:rescue]]
#+END_SPAN6
#+END_ROW-FLUID
#+END_CONTAINER-FLUID

#+END_CENTER

#+BEGIN_RESUME
My name is Masataro Asai, in this presentation, as other people do, Id like to 
give a brief introduction to my research field and what I do.
#+END_RESUME
#+END_outline-text-1

* Who are they?

#+BEGIN_CONTAINER-FLUID
#+BEGIN_ROW-FLUID
#+BEGIN_SPAN6
[[png:astro/1]]
#+END_SPAN6
#+BEGIN_SPAN6
[[png:rescue/1]]
#+END_SPAN6
#+END_ROW-FLUID
#+END_CONTAINER-FLUID

 #+BEGIN_RESUME
 And let me introduce these robots.
 The guy in the left is Astro boy.
 #+END_RESUME

** Who is he?

#+BEGIN_CONTAINER-FLUID
#+BEGIN_ROW-FLUID
#+BEGIN_SPAN6
[[png:astro/2]]
#+END_SPAN6
#+BEGIN_SPAN6
[[png:rescue/1]]
#+END_SPAN6
#+END_ROW-FLUID
#+END_CONTAINER-FLUID

#+BEGIN_RESUME
As you know, he is a famous manga superhero invented by Tezuka Osamu in 50s,
#+END_RESUME

** Who is he?

 #+BEGIN_CONTAINER-FLUID
 #+BEGIN_ROW-FLUID
 #+BEGIN_SPAN6
 [[png:astro/final]]
 #+END_SPAN6
 #+BEGIN_SPAN6
 [[png:rescue/1]]
 #+END_SPAN6
 #+END_ROW-FLUID
 #+END_CONTAINER-FLUID

#+BEGIN_RESUME
and he can think, hear, speak, act. he also has emotions.
#+END_RESUME

** Who is he?

 #+BEGIN_CONTAINER-FLUID
 #+BEGIN_ROW-FLUID
 #+BEGIN_SPAN6
 [[png:astro/final]]
 #+END_SPAN6
 #+BEGIN_SPAN6
 [[png:rescue/2]]
 #+END_SPAN6
 #+END_ROW-FLUID
 #+END_CONTAINER-FLUID

#+BEGIN_RESUME
 In contrast, the guy in the right is a real robot that is actually in use @ fukuoka prefecture for the rescue purpose..
 His name is T-52 Enryu, developped by a Japanese company Temzak.
 He is huge and powerful -- about 4 meters in height and can carry things which is as heavy as 500kg.
 Well, so, in a sense, he is also a superhero in the real disastrous situation.
#+END_RESUME

** Who is he?

 #+BEGIN_CONTAINER-FLUID
 #+BEGIN_ROW-FLUID
 #+BEGIN_SPAN6
 [[png:astro/final]]
 #+END_SPAN6
 #+BEGIN_SPAN6
 [[png:rescue/3]]
 #+END_SPAN6
 #+END_ROW-FLUID
 #+END_CONTAINER-FLUID

#+BEGIN_RESUME
But does he have feelings or can he think? Can he even move around by his own?
#+END_RESUME

** Who is he?

 #+BEGIN_CONTAINER-FLUID
 #+BEGIN_ROW-FLUID
 #+BEGIN_SPAN6
 [[png:astro/final]]
 #+END_SPAN6
 #+BEGIN_SPAN6
 [[png:rescue/final]]
 #+END_SPAN6
 #+END_ROW-FLUID
 #+END_CONTAINER-FLUID

#+BEGIN_RESUME
No. It requires full human intervention --- it is indeed operated by a
driver who gets in or by a remote control. It is more like a
super-sophisticated shovel car.
#+END_RESUME

* Impractical


#+BEGIN_CONTAINER-FLUID
#+BEGIN_ROW-FLUID
#+BEGIN_SPAN2
[[png:rescue]]
[[png:rescue]]
[[png:rescue]]
[[png:silent]]
#+END_SPAN2
#+BEGIN_SPAN10
[[jpg:static/tsunami]]
#+END_SPAN10
#+END_ROW-FLUID
#+END_CONTAINER-FLUID


#+BEGIN_RESUME
Now the problem is : It's ok in small accidents but is impractical in the real, massive 
natural disaster which frequently occurs in Japan.
The key resource is human ---
These special purpose vehicles require human intervention,
thus they are useless without trained operators.
#+END_RESUME

** Human Resource and Training


#+BEGIN_CONTAINER-FLUID
#+BEGIN_ROW-FLUID
#+BEGIN_SPAN4
 [[png:rescue/1]]
#+END_SPAN4
#+BEGIN_SPAN8
More operators -- Impossible due to 4 reasons

  + ✘ /Time/ matters :: Training requires ＞100hrs?
    + ✘ quickly increase the operators
  + ✘ /＄＄＄＄/ matters :: Cost of trainers, places, equipments
  + ✘ Skills need /Maintainance/ :: periodical training
  + ✘ Skills are /Useless/ in normal situation :: Society cannot torelate the extra cost!
#+END_SPAN8
#+END_ROW-FLUID
#+END_CONTAINER-FLUID

#+BEGIN_RESUME
In a natural disaster, we need as many experienced operators as possible.
However, it is virtually impossible due to several reasons. 

First, training takes time.
It is impossible to quickly increase the number of operators as needed, at the time of disaster.

Second, the money matters.
Training a person costs a lot of money, including: the cost of maintaining
a training center, the cost of additional vehicles for training, the cost
of training the trainers, wages for trainers, etc.

Third, Skills need to be updated and maintained.
You know, how about preparing the large number of operators in advance?
No, the society cannot torelate the cost of keep training them.
Operators may lose the skills and skills may become outdated.

Finally, in a normal situation, those skills are useless.
It forces the society to waste a great amount of extra money.
#+END_RESUME

* Automated Planning

[[png:planning/1]]

#+BEGIN_RESUME
研究テーマのプランニングは、ロボットに、人間の助けを借りず、いかに自律して行動させるかを扱います。
これをモデル化したプランニング問題は、具体的な行動の列を求める 組合せ最適化問題です。

プランニング問題のタスクは、
センサーから初期状態とゴールを受け取って、被災者を助ける正しい手順を出力することです。

たとえば、この図では男性が瓦礫に埋まって助けを求めています。
プランニング機能のあるロボットは、コレに対して「男性を助けよ」という大まかな指示を受けます。
#+END_RESUME

* Automated Planning

[[png:planning/2]]

#+BEGIN_RESUME
指示の内容には、図のように初期状態とゴール、許可された行動のリストが入っています。
ロボットは、自動プランニングにより、人間の代わりに適切な行動を組み立てて、ゴールを自動で達成します。
#+END_RESUME

* Automated Planning

[[png:planning/final]]

#+BEGIN_RESUME
プランニングは汎用な枠組みなので、災害救助以外にも様々な問題に適用することができます。
現実の応用例では「宇宙探査機運行問題」や「企業ネットワーク脆弱性問題」も表現できます。

このように、プランニングは、難しい問題を汎用性を失わずに解くことを目指します。
#+END_RESUME

# 自動運転事故:
# ポリシーが決まっていないならそういうものは作るべきではない
# 危険だ

# しかし自動運転は自分の扱うプランニングとは違うので実は困らない

# ゴール設定は人間がやればいい
# ターゲットを決めた上で
# 全力で考えるのがプランニングの技術
# 効用関数を決めるのは人間
# いかにそれを実現するか
# あくまで命令に従うロボットであることを強調

# ドメインは消す
# アプリケーション
# 
# coreまでは実例
# 災害援助は将来
# 完全に分離
# 
# 掃除ドメインをメインに

# ** プランニングとは?
# 
# [[png:planning-4room]]

# #+BEGIN_RESUME
# 同じ掃除ドメインの4部屋インスタンスも表現できますし、
# 現実の応用例では「宇宙探査ドメイン」も表現できます。
# 
# このように、プランニングは、難しい問題を汎用性を失わずに解くことを目指します。
# 
# 仮に将来、写真のような救助ロボットにプランニングソルバを組み込めば、
# 被災者を発見した時に適切な行動を自ら選択できるようになるかもしれません。
# #+END_RESUME

* Where Automated P&S resides?

Between *Theory* and *Practice*

#+BEGIN_RESUME
Automated Planning is a branch of Aritificial Intelligence. 

It shares a lot of technology with Operations Research and Theoretical
Computer Science, and is considered a bridge between pure theory and
pure applications.
#+END_RESUME

[[png:planning2]]

* Q. Whats the difference between Deep Learning?

A. Possible, but *different layer*

#+BEGIN_CONTAINER-FLUID
#+BEGIN_ROW-FLUID
#+BEGIN_SPAN7
*Deep Learning*, *Machine Learning*
+ *Subsymbolic Input*
  + images, voice, random text...
+ *1-step Action Policy / Reflex agent*
  + Pablov's dog, self-driving cars
  + red light → stop.
  + Pedestrian → stop.
  + Curves → brake.
#+END_SPAN7
#+BEGIN_SPAN5
*Planning*
+ *Symbolic Input/Output*
  + logic, objects, rules
+ *Reasoning about 1000 step future*
  + Rescue Robots solve puzzles under complex environment
#+END_SPAN5
#+END_ROW-FLUID
#+END_CONTAINER-FLUID

* Reflex Agent vs Goal-based Agents

[[png:planning-deeplearning]]


* ICAPS14 paper

#+BEGIN_RESUME
Next I'd like to provide a bit more details of my recent work, only briefly.

In this work, we proposed an automated method for solving large repetitive problems
which are easy for human but difficult for programs.
It detects a certain kinds of loops based only from the logical relationships between facts and actions.
#+END_RESUME

[[png:assemble-icaps14]]

* KEPS14, ICAPS15 paper

#+BEGIN_RESUME
In this work, we generalized the proposed method by detecting and
categorizing the logical structure which forms each loop.
For example, programs do not know that cars consists of several parts such as doors, engines and tires.
#+END_RESUME

[[png:assemble-keps14-icaps15]]

* AAAI16 paper

#+BEGIN_RESUME
Finally, this work proposed a method which prevents programs being confused by the zero-cost actions.
Actions in planning problems usually have a cost, measured by some criteria such as time, fuel or effort.
Programs tend to minimize the cost of the result plan, 
however, they are confused when there are many zero-cost actions.
For example, imagine Amazon is trying to optimize their truck operations.
Automated planning can also be applied to such a purpose.
When they only concerns with the fuel consumption,
some actions are zero-cost, like, the amount of labor on each driver is ignored.
#+END_RESUME

[[png:aaai16]]

* Future career plan?

APPLY TO THE INTERNSHIP PROGRAMS: Google, Amazon, IBM, ...

* 付録 古典プランニング問題とは (定義)

アクション集合 A, オブジェクト集合 O, 初期状態 I, ゴールG

*状態* := 真である命題の集合

*アクションa∈A* : < pre(a), add(a), del(a), cost(a) >

ただし、 pre(a): 前提条件, add(a): 追加効果, del(a): 削除効果, cost(a): アクションの適用コスト

*状態sに対するアクションaの適用:* pre(a) ⊆ s の時に適用可能で、

　a(s) = ( s ∪ add(a) ) / del(a)

*終了判定*: s ⊇ G ならば ゴール達成

# どう面倒な質問が来るかを想定して予備スライド
# プランニングについて突っ込まれる
# こてん的プランニングであることが判明する

* 付録 古典プランニングを研究する意義は?

[[png:classical-meaning]]

* 付録 AIの倫理について
  
+ 研究内容は 漠然とした「AI」のうち *グラフ探索* の研究
+ 善悪の判断はそれ自体は行わない
+ 価値判断は与えられる入力の中にある = 使用者の価値観を反映する
+ 悪用の問題はある。しかし、自分としては、災害救助ロボットなど、人道的な応用を目指している

* 付録 ディープラーニングとどう違うのか

+ 機械学習を埋め込むことは可能だ
+ が、求められる推論の複雑さが根本的に違う → 独立した分野

#+BEGIN_CONTAINER-FLUID
#+BEGIN_ROW-FLUID
#+BEGIN_SPAN7
*ニューラルネット*, *DL*, *強化学習*
+ 入力: 現在のデータ、過去の履歴、報酬 etc..
+ 出力:
  + *次の1ステップ* のアクション選択ポリシー (強化学習)
  + *固定長の分類結果* (画像認識)
  + ある意味 状況に応じて脊髄反射 なエージェント
#+END_SPAN7
#+BEGIN_SPAN5
*プランニング*
出力:
+ *10ステップ, 100ステップ先* の未来を *先読み* した行動計画
+ ICAPS14,15の手法を使えば *数千ステップ* 先の未来まで先読みすることが出来る
#+END_SPAN5
#+END_ROW-FLUID
#+END_CONTAINER-FLUID

ただしプランニングに学習機を埋め込むことは *可能* (実例複数あり)

DLから見て、プランニングは *アプリケーション*

プランニングから見て、DLは *ツール*

両者の組み合わせは機会があればやってみたい

** 付録 ディープラーニング関連

趣味の一環で、Common Lisp から直接使えるGPGPUのライブラリを作成中 (DLを作ってみるため)

+ OpenCLベース
+ Lisp の文法を直接 OpenCL C に変換し実行するトランスレータ
+ OpenCLのメモリ管理を Lisp GC に埋め込み

* 付録 第五世代コンピュータとの違いは?

第五世代コンピュータ : 並列推論機械(Prologベース,ハードウェア,OS)

根本的なソフトウェア技術、 *探索技術* が未発達だった

| 第五世代                  | 現在                                |
|---------------------------+-------------------------------------|
| 後方全探索+バックトラック | *前方ヒューリスティック探索*        |
| Prologベース              | C/C++で高度に最適化されたプログラム |
|                           | State packing, 決定木, mutex...     |

今はベンチマーク問題 *1104問* のうち 5分で *800問* 前後解ける

仮に *当時のソフトウェア* を *現在のハードウェア* で動かしたとしても、 *100問も解けないだろう*

* 付録 Explicit Graph と Implicit Graph との違い


#+BEGIN_CONTAINER-FLUID
#+BEGIN_ROW-FLUID
#+BEGIN_SPAN4
*カーナビ、ソーシャルグラフなど* : Explicit Graph Search

グラフ全体がメモリ(〜数ペタバイト)または二次記憶(〜数ゼタバイト)に収まる

参考: 2012年の全世界のデジタルデータ: 数ゼタバイト (1ZB = 10^21 バイト)

AI and Web の分野など
#+END_SPAN4
#+BEGIN_SPAN8
*プランニングにおける探索グラフ* : Implicit Graph Search

地球に存在する全計算資源を集めても二次記憶に入らない

グラフのノード数は状態変数に対して *指数的に増加*

動的に必要な量のみメモリ確保をしないと問題が解けない

探索空間サイズの例:

3x3x3のルービックキューブ: 4.32 x 10^19 = 4 エクサバイト

4x4x4のルービックキューブ: 7.40 x 10^45 > 10^24 ゼタバイト

5x5x5のルービックキューブ: 2.83 x 10^74
#+END_SPAN8
#+END_ROW-FLUID
#+END_CONTAINER-FLUID

# 秋葉さんのボスがいるかもしれない

#+BEGIN_NOTE
Gantz et al. "The digital universe in 2020: Big data, bigger digital shadows, and biggest growth in the far east." IDC iView: IDC Analyze the Future 2007 (2012): 1-16.
#+END_NOTE


* 付録 似たような研究は誰がやっていますか どこでやられていますか

# いろんなバリエーションがある
# 自分の研究分野のことをどれぐらいわかっているのか

#+BEGIN_XLARGE
国内ですか、国外ですか？
#+BEGIN_CENTER
YES NO
#+END_CENTER
#+END_XLARGE

# ** 国内
# 
# 過去の業績のことですか、研究計画のことですか? 過去、未来
# 
# (研究計画で) あなたの研究と似ている研究は誰がやっているか?
# symmetry

# Nir Potcher,
# Carmel Domshrak,
# Erez Karpas,
# Maria Fox
# Malte Helmert

# (過去の業績で) あなたの研究と似ている研究は誰がやっているか?
# 
# Eyal Amir,
# Raz Nissim,
# Ronen Brafman,
# Anders Jonsson,
# Lukas Chrpa

# 今後のインパクトを聞かれているのか、
# 今までのインパクトを聞かれているのか
# 確認すること

* 付録 プランニングはマイナーで大したことのない分野?

日本にプランニングの研究室がない ≠ 世界で研究室がない

*ICAPS*, *SoCS* : 例年150人-200人の参加者を集めており大変盛況, 

*AAAI*, *IJCAI* : プランニングに関する論文は例年数十本採択 Proceedingsの一つの章をなす

*JAIR*, *AIJ* : 論文誌でもプランニングの論文は多い (JAIR Volume 54: 12本中 2本 がプランニング論文)

*主な研究室*:

MIT CSAIL (Brian Williams), Carnegie-Mellon, 

NASA (NASA Ames および NASA/Caltech JPL のそれぞれに20名以上の研究者), 欧州宇宙機関(ESA)

指導教員は NASA JPL AI Lab の元メンバー

* 付録 汎用性を失わずに解く?

*No Free Lunch 定理*: 最適化アルゴリズムの性能は *全問題の平均を取れば* 全て同じ

Q. NFL定理のもとで「汎用性を失わずに高速に解く」というのは不可能?

A. NFL定理は確かにそのように主張するが、プランニング分野の意味する「汎用性」は

*人間にとって有意義な問題の集合* における汎用性である。

#+BEGIN_CENTER
全プランニング問題の集合 ⊇ 人間にとって有意義な問題の集合
#+END_CENTER

従って、 *全問題の平均を取れば* という前提が成り立たない。

* TODO 付録 その研究は...

# + オリジナリティは idea について。 だからテクニカル
# ループの概念を検出する
# 
# + インパクトは user の話について。 だからapplication
# ループをけんすつしようという考え自体がプランニング業界で新た
#   + 過去ー現在のインパクト
#   + 未来のインパクト


|          | 重要度 | 評価                     | オリジナリティ         | 過去のインパクト              | 未来のインパクト     | 動機                             |
|----------+--------+--------------------------+------------------------+-------------------------------+----------------------+----------------------------------|
| ACP      |        | 発表した                 | ループの概念を検出     | はるかに巨大な問題            | 産業応用             | 人間プログラマでは追いつかない   |
|          |        | 難関学会                 |                        |                               | 大規模問題           |                                  |
|          |        |                          |                        |                               |                      |                                  |
|          |        |                          |                        |                               |                      |                                  |
| CAP      |        | 難関学会                 | 問題分割手法           | 大規模な問題                  | 産業応用             |                                  |
|          |        | 発表した                 | 柔軟な統合手法         | それまでの分割系の手法より    | 混ざった問題         |                                  |
|          |        | いくつか質問された       |                        | 広範囲に分割                  |                      |                                  |
|          |        | メールやり取り           |                        |                               |                      |                                  |
|          |        |                          |                        |                               |                      |                                  |
|----------+--------+--------------------------+------------------------+-------------------------------+----------------------+----------------------------------|
| AAAI16   |        | 三人中                   | 同コストのノードの分類 | 70年代からの定説を覆す        | 広範なグラフ探索問題 | 下界以外で改善したかった         |
|          |        | 二人の査読者に絶賛された |                        | 通常と異なる方法で性能改善    | 基礎技術             |                                  |
|          |        |                          |                        | コスト0は実応用によく使われる |                      |                                  |
|          |        |                          |                        |                               |                      |                                  |
|          |        |                          |                        |                               |                      |                                  |
|          |        |                          |                        |                               |                      |                                  |
|----------+--------+--------------------------+------------------------+-------------------------------+----------------------+----------------------------------|
| 過去全体 |        |                          |                        |                               |                      |                                  |
|          |        |                          |                        |                               |                      |                                  |
| 未来全体 |        |                          |                        |                               |                      |                                  |
|          |        |                          |                        |                               |                      |                                  |
| 過去未来 |        |                          |                        |                               |                      |                                  |
|          |        |                          |                        |                               |                      |                                  |
|          |        |                          |                        |                               |                      | グラフ探索の下界関数             |
|          |        | どちらも                 |                        |                               |                      |                                  |
| 対称性   |        | underinvestigated,       |                        |                               | 産業応用             | これの改善では改善に限界がある   |
|          |        | もっとしらべるべき       |                        |                               |                      | ことがわかっている               |
| 問題分割 |        | とされている             |                        |                               |                      | どちらも綺麗なアイディアではない |
|          |        |                          |                        |                               |                      | 産業応用                         |
| 融合     |        |                          |                        |                               |                      |                                  |
|          |        |                          |                        |                               |                      |                                  |

# 一二年の成果なのでまだ引用はありませんが
# その分野の研究者が集まる採択率33の場で発表してきました 
# 口頭での会話でも上場で、いまもメールで交流をしています etc.
# 
# 評価は? : この論文は、採択率の厳しい難関国際学会に採択されました。
# このことだけでも、研究内容の正しさと重要さを認められたと考えています。

# ** 未来全体
# 
# 未来の事ならば、業績に関連するスライドに戻る。
# それのおかげで何ができるかを話す。

# math
# learning
# robotics -- "general enough to be applicable/scalable in this area"

# 対称性 --- 
# 
# プランニングの表現力の中で表現できるすべての問題の中で適用できる
# 対称性検知手法を制作する。

** 国内で誰が似たようなことをやっているか

この専門分野をやっている人は少ないんですが、
少し離れているが最も似ている研究というと

SATソルバの研究の人はいる -- 田中先生

推論系 -- logic and reasoning

Lemma Reusing for SAT based Planning and Scheduling
ICAPS 10年ぐらい前 NIIの井上勝海 CSP でプランニング

神戸大学
田沼先生 SAT

九大 横尾誠先生
AAMAS マルチエージェントCSP

自分の指導教官がアメリカから飛んできた研究者なので、もともと日本にいなかった研究者だった

スライド2を見せる

ERATOの人は同じくグラフ探索をやっていますが、
explicit/implicit の違いがあります。
瓦林先生
秋葉さん

Katsutoshi Hirayama, Kobe university  (constraint optimization, CSP, distributed CSP)

Toru Ishida (Kyoto U. stopped working in search a long time ago, but for a while, he was the leader in A*-related search methods in Japan; coauthored some papers with Korf).

* 付録 学会論文の位置づけ

# * 付録 AAAI, ICAPS とは?
# 
# *AAAI* : 人工知能(AI)系で最も権威のある国際学会
# 
# [[png:aaai-microsoft]]
# 
# # 組織の名前でもあり会議の名前でもある
# 
# * AAAI の下部学会
# 
# [[png:aaai-conferences]]
# 
# * ICAPS とは？
# # 人数と論文数が少ないので知名度は高くないが...
# 
# [[png:icaps-msai-core]]
# 
# CORE(ERA) Conference Ranking: A* オーストラリア/ニュージーランドの機関によるランキング

* HTN と ICAPS-15 の違い

HTNは人間が問題分割を行う
人件費を考えると非常にコストパフォーマンスが悪い
→ 自動で問題分割

* 付録 Q&A

+ Q. 探索空間の比較について、なぜ「以前」の数字がスライドによって変わるの?
+ A. 論文の中で使った実験設定が異なるからです。

* 付録 今後のキャリアパスは？

研究者押しで押しまくる
大学あるいは企業の研究者
迷うことなくパッと答える

* 付録 今後の研究計画が、インパクトの少ない今までの延長のように見えるんだけど・・・


* 付録 アドホックな解法に見えるんだけど・・・


* 付録 失敗しそうなんだけど・・・


* 付録?? とにかくまとはずれな質問

引き出しを探るタイプの質問



上席研究員
主任研究員

senior engineer

4段階

下
associate
XX
senior
principal
上

PI principal investigator

time sink
